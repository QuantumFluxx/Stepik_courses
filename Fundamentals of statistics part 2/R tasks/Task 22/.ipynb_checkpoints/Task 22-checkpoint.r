{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "9530b34f",
   "metadata": {},
   "source": [
    "Вот и подходит к концу наш курс. Давайте построим финальный график!\n",
    "\n",
    "В данных swiss, используя все переменные, выделите два кластера при помощи иерархической кластеризации и сохраните значение кластеров как фактор в переменную cluster.\n",
    "\n",
    "Затем визуализируйте взаимосвязь переменных  Education и  Catholic в двух выделенных кластерах, чтобы получился следующий график:\n",
    "![](https://ucarecdn.com/d45bdd96-8a16-4074-a62d-1ac7e0dc99eb/)\n",
    "\n",
    "— для визуализации линейной регрессии пользуйтесь geom_smooth();\n",
    "\n",
    "— точки проще всего добавить с помощью geom_point().\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f9d6da6b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "library(ggplot2)\n",
    "\n",
    "smart_hclust<-  function(test_data, cluster_number){\n",
    "  matr <- dist(test_data, method = \"euclidean\", diag = FALSE, upper = FALSE, p = 2)\n",
    "  fit <- hclust(matr, method = \"complete\", members = NULL)\n",
    "  test_data$cluster <- factor(cutree(fit, cluster_number))\n",
    "  return(test_data)\n",
    "}\n",
    " \n",
    "swiss <- smart_hclust(swiss,2)\n",
    "my_plot <- ggplot(swiss, aes(Education, Catholic, col = cluster))+\n",
    "  geom_smooth(method = lm, formula = y~x)+\n",
    "  geom_point()\n",
    "my_plot"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "3.6.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
